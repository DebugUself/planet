<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>











<head>
<title>Planet DebugUself</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="generator" content="Planet/2.0 +http://www.planetplanet.org">
<link rel="stylesheet" href="planet.css" type="text/css">
<link rel="alternate" href="http://planet.du.zoomquiet.us/atom.xml" title="" type="application/atom+xml">
</head>

<body>
<h1>Planet DebugUself</h1>

<div class="daygroup">
<h2>August 20, 2017</h2>

<div class="channelgroup">







<h3><a href="http://blog.junyu.io/" title="浚宇的博客">junyu</a></h3>


<div class="entrygroup" id="http://blog.junyu.io/posts/0016-cover-page-config.html">
<h4><a href="http://blog.junyu.io/posts/0016-cover-page-config.html">给博客穿件外套</a></h4>
<div class="entry">
<div class="content">
<blockquote class="blockquote-center">你的博客，你的使用手册</blockquote>

<a id="more"></a>
<p>这是我一直以来想做的一件事情，在博客的外面加上个人主页，我们散落在互联网上的痕迹越来越多，也越来越凌乱。甚至对作者本身搞清楚自己到底有多少网上的“作品”都是很复杂的一件事情。这时候增加一个个人主页显得尤为重要。</p>
<p>有趣的事情是在Google学术信息时，现代重要的学术大拿几乎人人都有个人主页，不一定会写博客，但是一定会把自己的作品、联系方式、论文、研究方向等统统放出来，供大家使用。而<a href="http://zoomquiet.io/" target="_blank" rel="external">Zoom.Quite</a>的主页极富一个有趣的极客灵魂感。内容之多也是印象深刻。</p>
<p>我之前做过几次尝试，但是效果都不是很理想，也没有找到特别好的办法，今天再次尝试，终于一鼓作气先完成了一个可用的及格版本，写一写，留个纪念。</p>
<h2 id="Github-Pages"><a href="http://blog.junyu.io/atom.xml#Github-Pages" class="headerlink" title="Github Pages"></a>Github Pages</h2><p>Github Pages 是Github 的一个项目，通过在Github托管代码的方式把静态页面组装成可以展示的页面。<a href="https://github.com/showcases/github-pages-examples" target="_blank" rel="external">这里</a>有大量的示例。<br /><a href="https://pages.github.com/" target="_blank" rel="external">主页</a>的视频一目了然，不再赘述。<br />我的主页就是通过Github Pages生成的，使用的是默认的模版，如果不做过多的定制化，仅仅是在主页修改文字的话，内容非常非常的简单。参考我的<a href="https://github.com/Wangjunyu/Leon.junyu" target="_blank" rel="external">仓库</a>。对于这个主题，自己现在还是很满意的。</p>
<h2 id="域名设置"><a href="http://blog.junyu.io/atom.xml#域名设置" class="headerlink" title="域名设置"></a>域名设置</h2><p>以往二级域名的设置已经驾轻就熟。</p>
<blockquote>
<p>以blog.junyu.io的设置为例，在域名服务解析的服务页面修改模式为CNAME，把指向的地址修改为：wangjunyu.gitub.io. ，保存即可。如果还无法连接，回到Github查看设置，一般的做法是增加CNAME文件，修改默认分支为gh-pages。</p>
</blockquote>
<p>这一次设置的是一级域名以及开头为www 的跳转，按照之前的方式设置始终无法生效。之后从官方文档的<a href="https://help.github.com/articles/using-a-custom-domain-with-github-pages/" target="_blank" rel="external">Using a custom domain with GitHub Pages
</a>开始一页一页的找，终于在<a href="https://help.github.com/articles/about-supported-custom-domains/#apex-domains" target="_blank" rel="external">About supported custom domains
</a>找到了端倪：</p>
<blockquote>
<p>An apex domain is usually configured with an A, ALIAS, or ANAME record through your DNS provider.</p>
</blockquote>
<p>对于一级域名的设置，一般是在填写二级域名的地方写上<code>@</code>，选择A 或者ALIAS 模式，跳转的地址需要使用ip，在上面提到的文档中有提到。修改之后，还可以用文档中提到的’dig’ 命令进行测试。貌似一级域名的调整需要一些时间，不过一般来说十几分钟也就够了。</p>
<p>最后，展示一下我的<a href="http://junyu.io" target="_blank" rel="external">主页</a></p>
<h2 id="Reference"><a href="http://blog.junyu.io/atom.xml#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a href="https://help.github.com/articles/setting-up-an-apex-domain/" target="_blank" rel="external">Setting up an apex domain</a></li>
<li><a href="https://help.github.com/articles/setting-up-an-apex-domain-and-www-subdomain/" target="_blank" rel="external">Setting up an apex domain and www subdomain</a></li>
<li><a href="https://help.github.com/articles/about-supported-custom-domains/#www-subdomains" target="_blank" rel="external">About supported custom domains
</a></li>
</ul>
<blockquote class="blockquote-center"><a href="http://blog.junyu.pro" target="_blank" rel="external">完</a></blockquote>


<h2 id="ChangeLog"><a href="http://blog.junyu.io/atom.xml#ChangeLog" class="headerlink" title="ChangeLog"></a>ChangeLog</h2><p>170820 新建</p></div>







<p class="date">
<a href="http://blog.junyu.io/posts/0016-cover-page-config.html">August 20, 2017 12:03 PM</a>
</p>
</div>
</div>


</div>

</div>
<div class="daygroup">
<h2>August 18, 2017</h2>

<div class="channelgroup">







<h3><a href="http://du.zoomquiet.io/" title="自怼圈">Debug Uself grp.</a></h3>


<div class="entrygroup" id="http://du.zoomquiet.io/2017-08/aoi-crontab">
<h4><a href="http://du.zoomquiet.io/2017-08/aoi-crontab/">Aoi-crontab</a></h4>
<div class="entry">
<div class="content">
<h1 id="crontab-是位好伙伴">crontab 是位好伙伴</h1>

<p>planet 很简单粗暴,只是:</p>

<ul>
  <li>如何免费的发布成网站?</li>
  <li>又如何自动的刷新?</li>
</ul>

<!--more-->

<h2 id="github-pages">github-pages</h2>
<p>~ <a href="https://help.github.com/articles/user-organization-and-project-pages/">User, Organization, and Project Pages - User Documentation</a></p>

<p>第一时间想到 <code class="highlighter-rouge">github-pages</code> :</p>

<ul>
  <li>只是记忆中要一个特殊的孤子分支什么的…</li>
  <li>结果官方文档一看:
    <ul>
      <li>master, gh-pages, or a /docs folder on master</li>
      <li>嗯哼?! 可以用约定的一个 master 目录就可以了?</li>
    </ul>
  </li>
</ul>

<p><img src="http://openmindclub.qiniucdn.com/res/debuguself/github_pages_docs.png" alt="github_pages_docs.png（PNG 图像，494x548 像素）" /></p>

<p>果然…那就简单了</p>

<div class="highlighter-rouge"><pre class="highlight"><code>output_dir = docs
</code></pre>
</div>

<p>将相关配置文件中, 指定的输出目录变成 <code class="highlighter-rouge">docs</code>,
每次 push 到 github 时,就完成了网站的更新.</p>

<h2 id="定期的嗯哼">定期的嗯哼</h2>
<p>~ 在所有 UNIX/Linux 环境中, 当前是 crontab</p>

<p>参考:<a href="https://help.ubuntu.com/community/CronHowto">CronHowto - Community Help Wiki</a></p>

<p>先在用户 crontab 中配置</p>

<div class="highlighter-rouge"><pre class="highlight"><code># m h  dom mon dow   command
*/10 *     * * *   /opt/cron/updates.sh
</code></pre>
</div>

<p>每 10 秒调用一次 <a href="https://github.com/zoom-quiet/scm/blob/master/sh/cron/updates.sh">updates.sh</a> 以便调试</p>

<p>调试好后, 更新配置为</p>

<div class="highlighter-rouge"><pre class="highlight"><code># m h  dom mon dow   command
42 */8     * * *   /opt/cron/updates.sh
</code></pre>
</div>

<p>每8小时的第42分钟,运行一次, 并将日志输出为:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>opt/log/cron on default
$ ls -1
170818-planet.log
170819-planet.log
170820-planet.log
170821-planet.log
</code></pre>
</div>

<p>这种形式…</p>

<h2 id="整体图谱">整体图谱</h2>
<p>~ 所以, 最终通过一台家用服务器, 无值守的完成了一大类静态网站的更新和发布</p>

<div class="highlighter-rouge"><pre class="highlight"><code>                            du.zoomquiet.io/planet/
                                  ^ 
                                  |
                          [[github-pages]]
{rss} {rss} ... {rss}             ^
  \     |         /               |
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        internet                  ^
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        home wifi                 ^ 
            |                     |
            V                     |
        Ubuntu 16.4               | 
       /[ miniPC ]                |
      /     |                     |
  crontab   |                     |
    |       V                     +
    +---&gt;(Planet) --&gt; HTML -&gt; git push
</code></pre>
</div>

<h1 id="todo">TODO</h1>
<p>~ 当然的故事远没有可以结束, 等待继续折腾的有:</p>

<ul>
  <li>固化 wifi 连接的 ip</li>
  <li>在 pyenv 中也能安装使用 baddb</li>
  <li>将更新成果 email 给自己,以便知晓</li>
  <li>将失败的更新 通过短信/微信/Slcak 等等渠道提醒自己</li>
  <li>通过 Slack 或是其它渠道, 可以发布指令给主机进行各种必要的行为</li>
  <li>…</li>
</ul>

<h1 id="用时">用时</h1>

<ul>
  <li>.5h 研究 github-pages 文档</li>
  <li>1.h 实验明确 docs 效果</li>
  <li>1.h 调试 crontab 脚本</li>
  <li>.5h 测试全部自动化行为</li>
  <li>1.h ASCII 图谱和文档化</li>
</ul></div>







<p class="date">
<a href="http://du.zoomquiet.io/2017-08/aoi-crontab/">August 18, 2017 12:00 AM</a>
</p>
</div>
</div>


</div>

</div>
<div class="daygroup">
<h2>August 17, 2017</h2>

<div class="channelgroup">







<h3><a href="http://du.zoomquiet.io/" title="自怼圈">Debug Uself grp.</a></h3>


<div class="entrygroup" id="http://du.zoomquiet.io/2017-08/aoi-planet">
<h4><a href="http://du.zoomquiet.io/2017-08/aoi-planet/">Aoi-planetDUer</a></h4>
<div class="entry">
<div class="content">
<h1 id="planet-是个好同志">Planet 是个好同志</h1>

<p><img src="http://www.planetplanet.org/img/planet_text.png" alt="planet_text" /></p>

<p>13年前用过,那时, 代码就已经不更新了…
为什么? 实在是一下子就写到完美了!</p>

<!--more-->

<p>毕竟功能异常单纯, 就是将指定的 RSS 之类聚合数据, 按照日期整理为一页 HTML,</p>

<ul>
  <li><a href="http://planetpython.org/">Planet Python</a></li>
  <li><a href="http://planet.haskell.org/">Haskell</a></li>
  <li><a href="http://planet.lisp.org/">Lisp</a></li>
  <li><a href="http://planet.perl.org/">Perl</a></li>
  <li><a href="http://www.planetmysql.org/">MySQL</a></li>
  <li><a href="http://planet.postgresql.org/">PostgreSQL</a></li>
  <li>…</li>
</ul>

<p>当然的自怼圈也应该有!</p>

<h2 id="pyenv">pyenv</h2>
<p>~ 第一个要配置的还是 python 环境了</p>

<p>当然的 ubuntu 内置了 python 环境,
但是, 必须第一时间将系统 py 运行时和自己的开发环境有效隔离哪…</p>

<p>参考:</p>

<ul>
  <li><a href="https://github.com/pyenv/pyenv#installation">pyenv/pyenv: Simple Python version management</a>
    <ul>
      <li><a href="https://github.com/pyenv/pyenv/wiki">Troubleshooting / FAQ · pyenv/pyenv Wiki</a></li>
    </ul>
  </li>
  <li><a href="https://github.com/pyenv/pyenv-virtualenv">pyenv/pyenv-virtualenv: a pyenv plugin to manage virtualenv (a.k.a. python-virtualenv)</a></li>
</ul>

<p>进行快速配置就好…</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ sudo apt install git
$ cd /opt/repo
$ git clone https://github.com/pyenv/pyenv.git .pyenv
$ git clone https://github.com/pyenv/pyenv-virtualenv.git .pyenv/plugins/pyenv-virtualenv
</code></pre>
</div>

<p>配置<code class="highlighter-rouge">~/.bash_profile</code></p>

<div class="highlighter-rouge"><pre class="highlight"><code>##############################################################################
#   --&gt; PyEnv
##############################################################################
export PYENV_ROOT="/opt/repo/.pyenv"
export PATH="$PYENV_ROOT/bin:$PATH"

eval "$(pyenv init -)"
#   export PYENV_VIRTUALENV_DISABLE_PROMPT=0
eval "$(pyenv virtualenv-init -)"
</code></pre>
</div>

<p>激活加载:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ source ~/.bash_profile
</code></pre>
</div>

<p>安装编译工作用 python 环境:</p>

<div class="highlighter-rouge"><pre class="highlight"><code># 先得安装一堆编译依赖工具/库
$ sudo apt install -y make build-essential libssl-dev zlib1g-dev \
    libbz2-dev libreadline-dev libsqlite3-dev \
    wget curl llvm libncurses5-dev xz-utils tk-dev

$ pyenv install --list
...
    可以感叹一下支持的发行版有多丰富

$ pyenv install 3.6.2
...
$ pyenv install 2.7.13
...
$ pyenv rehash

$ pyenv virtualenv 2.7.13 2713DAMA
...
You are using pip version 6.1.1, however version 9.0.1 is available.
You should consider upgrading via the 'pip install --upgrade pip' command.
...
$ pyenv virtualenv 3.6.2 362CV3

$ pyenv rehash

$ pyenv versions
* system (set by /opt/repo/.pyenv/version)
  2.7.13
  2.7.13/envs/2713DAMA
  2713DAMA
  3.6.2
  3.6.2/envs/362CV3
  362CV3
</code></pre>
</div>

<p>实际使用情景:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>zoomq @ aoi in ~
$ cd /opt
zoomq @ aoi in /opt on default

$ pyenv 2712DAMA 

(2712DAMA)
zoomq @ aoi in /opt on default
$ cd app

(2712DAMA)
zoomq @ aoi in /opt/app on default
$ python
Python 2.7.12 (default, Nov 19 2016, 06:48:10)
[GCC 5.4.0 20160609] on linux2
Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;&gt;

zoomq @ aoi in /opt/app on default
$ cd ../log

zoomq @ aoi in /opt/log on default
$ pyenv local 362CV3

(362CV3)
zoomq @ aoi in /opt/app on default
$ python
Python 3.6.2 (default, Aug 17 2017, 23:28:25)
[GCC 5.4.0 20160609] on linux
Type "help", "copyright", "credits" or
&gt;&gt;&gt;
</code></pre>
</div>

<h2 id="部署-planet">部署 planet</h2>
<p>~ 情况并没有想象的那么简单…</p>

<p>毕竟是有快10年没有更新的工程了, 使用配置方式没有变,
快速根据模板完成了配置, 一运行:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ python code/planet.py config/du.ini
Traceback (most recent call last):
  File "code/planet.py", line 24, in &lt;module&gt;
    import planet
  File "/opt/www/planet/code/planet/__init__.py", line 35, in &lt;module&gt;
    import dbhash
  File "/opt/repo/.pyenv/versions/2.7.13/lib/python2.7/dbhash.py", line 7, in &lt;module&gt;
    import bsddb
  File "/opt/repo/.pyenv/versions/2.7.13/lib/python2.7/bsddb/__init__.py", line 67, in &lt;module&gt;
    import _bsddb
ImportError: No module named _bsddb
</code></pre>
</div>

<p>嗯哼, 这事儿听说过,因为版权的问题, 从2.5版本后, 将 bsddb 从内置模块中移除了,
所以…</p>

<ul>
  <li><a href="https://stackoverflow.com/questions/28253731/importerror-no-module-named-bsddb-when-opening-shelve-in-docker-container">python - “ImportError: No module named _bsddb” when opening shelve in Docker container - Stack Overflow</a></li>
  <li><a href="https://stackoverflow.com/questions/16003224/installing-bsddb-package-python">osx - Installing bsddb package - python - Stack Overflow</a></li>
  <li><a href="http://marc-abramowitz.com/archives/2007/11/28/hacking-os-xs-python-dbhash-and-bsddb-modules-to-work/">Hacking OS X’s Python dbhash and bsddb modules to work | Marc Abramowitz</a></li>
  <li><a href="https://pypi.python.org/pypi/bsddb3/6.2.4">bsddb3 6.2.4 : Python Package Index</a></li>
  <li>…</li>
</ul>

<p>当然,有很多方式可以弥补, 最简单的:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ pip install bsddb3
Collecting bsddb3
  Using cached bsddb3-6.2.4.tar.gz
    Complete output from command python setup.py egg_info:
    Can't find a local Berkeley DB installation.
    (suggestion: try the --berkeley-db=/path/to/bsddb option)

    ----------------------------------------
Command "python setup.py egg_info" failed with error code 1 in /tmp/pip-build-ST2bF0/bsddb3/
</code></pre>
</div>

<blockquote>
  <p>/path/to/bsddb</p>
</blockquote>

<p>有独立的 bsddb 产品?</p>

<ul>
  <li><a href="http://www.linuxfromscratch.org/blfs/view/stable/server/db.html">Berkeley DB-6.2.23</a></li>
  <li><a href="https://www.jcea.es/programacion/pybsddb.htm">Python “bindings” for Oracle Berkeley DB</a></li>
  <li>好吧, 忒复杂了…</li>
</ul>

<p>于是选择相信 Ubuntu 的软件仓库:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ apt search bsddb
Sorting... Done
Full Text Search... Done
python-bsddb3/xenial,now 6.1.0-1build2 amd64 [installed]
  Python interface for Berkeley DB

python-bsddb3-dbg/xenial 6.1.0-1build2 amd64
  Python interface for Berkeley DB (debug extension)

python-bsddb3-doc/xenial,xenial 6.1.0-1build2 all
  Documentation for the python Berkeley DB interface module

python3-bsddb3/xenial 6.1.0-1build2 amd64
  Python interface for Berkeley DB (Python 3.x)

python3-bsddb3-dbg/xenial 6.1.0-1build2 amd64
  Python interface for Berkeley DB (debug extension, Python 3.x)
</code></pre>
</div>

<p>那就简单了:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ sudo apt install python-bsddb3
$ pip list
adium-theme-ubuntu (0.3.4)
bsddb3 (6.1.0)
mercurial (3.7.3)
pip (8.1.1)
setuptools (20.7.0)
unity-lens-photos (1.0)
wheel (0.29.0)

$ python
Python 2.7.12 (default, Nov 19 2016, 06:48:10)
[GCC 5.4.0 20160609] on linux2
Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;&gt; import bsddb3
&gt;&gt;&gt; dir(bsddb3)
['MutableMapping', '_DBWithCursor', '_DeadlockWrap', '__builtins__', '__doc__', '__file__', '__name__', '__package__', '__path__', '__version__', '_checkflag', '_db', '_iter_mixin', '_openDBEnv', '_pybsddb', 'absolute_import', 'btopen', 'collections', 'db', 'dbutils', 'error', 'hashopen', 'os', 'ref', 'rnopen', 'sys']
&gt;&gt;&gt;
</code></pre>
</div>

<h3 id="in-pyenv-">in pyenv ?</h3>
<p>只是比较尴尬的, 这样一来, 只能使用系统 python 2.7.12</p>

<p>之前通过 pyenv 安装的 2.7.14/3.6.2 什么的都无法正常驱动 planet 了…</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ python code/planet.py config/du.ini
DEBUG:planet.runner:Socket timeout set to 20 seconds
INFO:planet.runner:Loading cached data
INFO:planet:Updating feed &lt;http://du.zoomquiet.io/atom.xml&gt;
DEBUG:planet:Last Modified: 2017-08-21T10:00:52+00:00
DEBUG:planet:Items in Feed: 12
...
INFO:planet.runner:Processing template config/index.html.tmpl
INFO:planet.runner:Writing docs/index.html
INFO:planet.runner:Processing template config/atom.xml.tmpl
INFO:planet.runner:Writing docs/atom.xml
INFO:planet.runner:Processing template config/rss20.xml.tmpl
INFO:planet.runner:Writing docs/rss20.xml
INFO:planet.runner:Processing template config/rss10.xml.tmpl
INFO:planet.runner:Writing docs/rss10.xml
INFO:planet.runner:Processing template config/opml.xml.tmpl
INFO:planet.runner:Writing docs/opml.xml
INFO:planet.runner:Processing template config/foafroll.xml.tmpl
INFO:planet.runner:Writing docs/foafroll.xml
</code></pre>
</div>

<p>不过, 没关系先用起来再说 <code class="highlighter-rouge">(￣▽￣)</code></p>

<p>好在也额外的学到从 shell 脚本中调用 pyenv 环境的技巧:</p>

<ul>
  <li><a href="https://github.com/pyenv/pyenv/issues/492">Is there a preferred way to use pyenv in a shell script? · Issue #492 · pyenv/pyenv</a></li>
  <li>pyenv 原作者的分享:
    <ul>
      <li>Both PYENV_VERSION and pyenv shell should work even in shell scripts. Latter requires you to add eval “$(pyenv init -)” in your script, though.</li>
      <li>Personally I like to use PYENV_VERSION since it doesn’t require additional shell setup….</li>
    </ul>
  </li>
</ul>

<p>e.g:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c">#!/bin/bash</span>
<span class="c"># Set version to 2.7.10</span>
<span class="nb">export </span><span class="nv">PYENV_VERSION</span><span class="o">=</span>2.7.10

<span class="c"># DO STUFF</span>
<span class="c"># python --version # ==&gt; Python 2.7.10</span>

<span class="c"># Reset version</span>
<span class="nb">unset </span>PYENV_VERSION
</code></pre>
</div>

<blockquote>
  <p>直接使用环境变量来切换就对了</p>
</blockquote>

<h1 id="用时">用时</h1>

<ul>
  <li>.5h install pyenv</li>
  <li>1.5h 各种 py 环境安装/镜像</li>
  <li>1.h <em>bsddb</em> 问题研究</li>
  <li>.5h 完成 planet 工作驱动</li>
</ul></div>







<p class="date">
<a href="http://du.zoomquiet.io/2017-08/aoi-planet/">August 17, 2017 12:00 AM</a>
</p>
</div>
</div>


</div>

</div>
<div class="daygroup">
<h2>August 15, 2017</h2>

<div class="channelgroup">







<h3><a href="http://liguanghe.github.io/" title="Li Guanghe's blog">li guang he</a></h3>


<div class="entrygroup" id="http://liguanghe.github.io/2017/08/16/KeepTogether/">
<h4><a href="http://liguanghe.github.io/2017/08/16/KeepTogether/">丑照何时曝, 当然变美时 —— 运动follower 招募</a></h4>
<div class="entry">
<div class="content">
<p><a href="https://www.lizhi.fm/2040956/2618588406176141318" target="_blank" rel="external">【dunedin keep hit together】在线收听<em>李广鹤</em>荔枝FM</a></p></div>







<p class="date">
<a href="http://liguanghe.github.io/2017/08/16/KeepTogether/">August 15, 2017 09:35 PM</a>
</p>
</div>
</div>



</div>
<div class="channelgroup">







<h3><a href="http://du.zoomquiet.io/" title="自怼圈">Debug Uself grp.</a></h3>


<div class="entrygroup" id="http://du.zoomquiet.io/2017-08/aoi-init">
<h4><a href="http://du.zoomquiet.io/2017-08/aoi-init/">Aoi-初始化</a></h4>
<div class="entry">
<div class="content">
<h1 id="是也乎">是也乎,(￣▽￣)</h1>

<p>就是要折腾…所以,来一台 miniPC 吧</p>

<!--more-->

<h2 id="背景">背景</h2>
<p>海外主机解决了科学上网的问题,</p>

<ul>
  <li>但是, 带宽/CPU/内存/硬盘IP/… 什么都要銭,</li>
  <li>而且远程登录控制响应也很难受</li>
</ul>

<p>所以, 想临时测试, 或是部署一些周期性的自动化私人任务总是要有个</p>

<div class="highlighter-rouge"><pre class="highlight"><code>home server
家庭服务器
</code></pre>
</div>

<p>来长期运行, 内网使用</p>

<h2 id="硬件">硬件</h2>
<p>~ 根据预算暂时选定</p>

<p>工控机形式, 可以长期在家运行,节能…最后决定采购的是类似以下的配置:</p>

<p><img src="https://img.alicdn.com/imgextra/i2/3035203165/TB2aYpfXZtnpuFjSZFvXXbcTpXa_!!3035203165.jpg_q90.jpg" alt="TB2aYpfXZtnpuFjSZFvXXbcTpXa_!!3035203165.jpg_q90.jpg（JPEG 图像，777x818 像素）" /></p>

<h2 id="系统">系统</h2>
<p>~ 必须是稳健的 Linux 了</p>

<p>只是以往长期用过 Ubuntu 系统, 而且从用户群看, Ubuntu 支持的硬件范围也最广,
果然和店家商量, 人家预装的就是 LST 版本的 Ubuntu…</p>

<h3 id="bash">bash</h3>

<p>拿到手, 用初始管理员帐号进入后, 习惯性的配置顺序是:</p>

<ol>
  <li>创建自己习惯的帐号</li>
</ol>

<p>:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ sudo su 
# useradd -s /bin/bash -G sudo,root zoomq
# chown -R zoomq:zoomq /home/zoomq
# passwd zoomq
&lt;-- 新的强力临时口令
</code></pre>
</div>

<ul>
  <li>更换/关闭原先的帐号</li>
</ul>

<p>:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ sudo su 
# passwd admin
&lt;-- 新的强力口令
</code></pre>
</div>

<ul>
  <li>
    <p>配置 /etc/sudoers</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>  # Allow members of group sudo to execute any command
  #%sudo  ALL=(ALL:ALL) ALL
  %sudo ALL=(ALL) NOPASSWD:ALL
</code></pre>
    </div>
  </li>
  <li>接入网络 ~ 使用图形化工具即可</li>
  <li>升级系统软件 ~ 得先用图形工具, 选择合适的软件源仓库</li>
</ul>

<p>:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ sudo apt update
$ sudo apt upgrade
</code></pre>
</div>

<p>安装常用工具:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ sudo apt install htop vim
</code></pre>
</div>

<ul>
  <li>配置 SSH</li>
</ul>

<p>先安装 SSH 服务:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ sudo apt install openssh-server
</code></pre>
</div>

<p>再配置允许 SSH 登录:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ sudo vim /etc/ssh/sshd_config
...

#Port 22
Port 9122

...

PermitRootLogin yes
StrictModes yes

RSAAuthentication yes
PubkeyAuthentication yes
...

#PasswordAuthentication yes

$ sudo service ssh restart
</code></pre>
</div>

<ul>
  <li>部署私匙, 进行远程登录</li>
</ul>

<p>最后部署私人公匙:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ mkdir -p /home/zoomq/.ssh
$ touch /home/spawnris/.ssh/authorized_keys
$ chmod 600 /home/spawnris/.ssh/authorized_keys
从本地 ~/.ssh/id_rsa.pub 复制公匙到 authorized_keys 中
</code></pre>
</div>

<p>从本地 macOS 桌面中,配置 <code class="highlighter-rouge">~/.ssh/config</code> 追加:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Host aoi
    User zoomq
    port 9122
    ForwardAgent yes
    HostName 192.168.1.17
</code></pre>
</div>

<p>然后, 就可以从本地终端中使用如下指令随时登录主机了:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ ssh aoi
</code></pre>
</div>

<ul>
  <li>配置惯用的 bash 环境
    <ul>
      <li>配置 ~/<a href="https://github.com/zoom-quiet/scm/blob/master/bash/.inputrc">.inputrc</a></li>
      <li>配置 ~/<a href="https://github.com/zoom-quiet/scm/blob/master/bash/.bashrc">.bashrc</a></li>
      <li>才获得习惯的终端命令行前缀形式/颜色, 以及使用上下键能快速选择对应的历史指令了</li>
    </ul>
  </li>
</ul>

<h3 id="screen">screen</h3>
<p>~ 但是, 想真正自在的随时进入工作组终端, 还得继续…</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ sudo apt install screen
$ screen -S zoomq # 创建名为 zoomq 的终端组
</code></pre>
</div>

<p>screen….常用操作</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Ctrl+a+c 新终端
Ctrl+a+w 列出所有终端
Ctrl+a+a 回到前一个终端
Ctrl+a+d 挂起并后台保持 screen

Ctrl+a+0 进入 id 为 0 的终端
Ctrl+a+1 进入 id 为 1 的终端
</code></pre>
</div>

<p>现在就可以一键从本地进入远程的终端组了:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ ssh -t aoi screen -r zoomq
</code></pre>
</div>

<p>而且, 随时使用 <code class="highlighter-rouge">ctrl+a+d</code> 断开连接, 回到本地, 
却对远程主机中的终端组,以及各个终端中的状态都完成了自动保存,
任何时候回来都可以继续上次的嗯哼…</p>

<h2 id="远程配置">远程配置</h2>
<p>~ 在远程使用 vim 来编辑各种脚本/配置, 还是没有在 mac 中用 sublime text 3 来的嗯哼</p>

<ul>
  <li>所以, 要有机制可以在本地编辑, 自动部署到远程主机中</li>
  <li>自然的, 想到了版本管理系统</li>
  <li>以往折腾过稳定的自动化部署</li>
  <li>基于 hg (<a href="https://www.mercurial-scm.org/">Mercurial</a>)</li>
</ul>

<p>整体文件提交/部署的关系是:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>            +- .hg -&gt; hooks -+
            |                |
        + /opt &lt;-------------+ (自动化同步更新工作复本)
        |   ^
        V   |
    [home server]
        |   |
        |   |
    [macOS local]
        |   ^  $ hg push
        |   |
        +- path/2/local/work/path
            +- .hg &lt;- 本地仓库
</code></pre>
</div>

<p>创建主机上的仓库:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ cd /opt
$ hg init .
$ vim .hg/hgrc

[web]
push_ssl=False
[hooks]
changegroup=/opt/cfg/hg/hooks/autoup-opt-up.sh
</code></pre>
</div>

<p>部署自动更新 hook -&gt; <a href="https://github.com/zoom-quiet/scm/blob/master/hg/hooks/autoup-opt-up.sh">autoup-opt-up.sh</a>:</p>

<ul>
  <li>创建对应目录 <code class="highlighter-rouge">/opt/cfg/hg/hooks</code></li>
  <li>放置对应脚本</li>
  <li>并设置为可执行 <code class="highlighter-rouge">chmod +x autoup-opt-up.sh</code></li>
</ul>

<p>回到 macOS 本地, 创建合理的本地复本环境:</p>

<ul>
  <li>配置 ~/<a href="https://github.com/zoom-quiet/scm/blob/master/hg/.hgrc">.hgrc</a></li>
  <li>注意其中有关配置的来源:
    <ul>
      <li><a href="https://bitbucket.org/sjl/mercurial-cli-templates/src">sjl / mercurial-cli-templates / source / — Bitbucket</a></li>
      <li><a href="https://bitbucket.org/sjl/hg-prompt/src">sjl / hg-prompt / source / — Bitbucket</a></li>
    </ul>
  </li>
</ul>

<p>效果:</p>

<p><img src="http://stevelosh.com/media/images/projects/hg-prompt/prompt.png" alt="prompt" /></p>

<ul>
  <li>至此, 在本地对应工作目录中创建/修订/增补有关配置/脚本, 通过 hg 命令完成版本记录后</li>
  <li>嘦简单的进行 <code class="highlighter-rouge">hg pu</code></li>
  <li>在远程主机, 就自动化的完成了相同的版本收录, 并更新到对应目录中的文件</li>
  <li>节省大量重复性操作</li>
</ul>

<h1 id="用时">用时</h1>

<ul>
  <li>.5h 开机配置</li>
  <li>1.h 系统升级</li>
  <li>.5h bash 常用配置</li>
  <li>1.h 回忆并部署 hg</li>
</ul></div>







<p class="date">
<a href="http://du.zoomquiet.io/2017-08/aoi-init/">August 15, 2017 12:00 AM</a>
</p>
</div>
</div>


</div>

</div>
<div class="daygroup">
<h2>August 12, 2017</h2>

<div class="channelgroup">







<h3><a href="http://liguanghe.github.io/" title="Li Guanghe's blog">li guang he</a></h3>


<div class="entrygroup" id="http://liguanghe.github.io/2017/08/12/DunedinWeekend/">
<h4><a href="http://liguanghe.github.io/2017/08/12/DunedinWeekend/">Weekend 周末小憩</a></h4>
<div class="entry">
<div class="content">
<p>Today I have a Dunedin day. I went to traditional market after programing, there are many local food there, fresh and unique. Musicians p</p></div>







<p class="date">
<a href="http://liguanghe.github.io/2017/08/12/DunedinWeekend/">August 12, 2017 11:35 AM</a>
</p>
</div>
</div>


</div>

</div>
<div class="daygroup">
<h2>August 11, 2017</h2>

<div class="channelgroup">







<h3><a href="http://blog.junyu.io/" title="浚宇的博客">junyu</a></h3>


<div class="entrygroup" id="http://blog.junyu.io/posts/1003-zq-2th-meetup.html">
<h4><a href="http://blog.junyu.io/posts/1003-zq-2th-meetup.html">深夜放毒后的嗯哼</a></h4>
<div class="entry">
<div class="content">
<blockquote class="blockquote-center">Py103 -&gt; Py104，Zoom Quite.again</blockquote>


<a id="more"></a>
<p>再见到大妈真身，俨然小半年过去了。乡音难改，单口继续，笑声爽朗，收获多多。</p>
<h2 id="ZoomQuiet-offline-refresh"><a href="http://blog.junyu.io/atom.xml#ZoomQuiet-offline-refresh" class="headerlink" title="ZoomQuiet.offline.refresh"></a>ZoomQuiet.offline.refresh</h2><ul>
<li>自带BGM出场的男人</li>
<li>全程自带BGM的男人</li>
</ul>
<h2 id="Python-Python-in-my-eye"><a href="http://blog.junyu.io/atom.xml#Python-Python-in-my-eye" class="headerlink" title="Python != Python in my eye"></a>Python != Python in my eye</h2><p>大家问了很多问题，刚开始接触编程，太多的不确定性带来的未知的恐惧感渗透在一个又一个问题里。</p>
<ul>
<li><p>编程恐惧</p>
<ul>
<li>发展路径是怎样的？</li>
<li>好奇你和Python的第一次相遇？</li>
<li>……<br />突破这种心理的最简单的方式是：编程。认真的编程，认真的思考，编程会变成一个又一个具体的问题or挑战，所以其实会变成克服一个又一个挑战的过程。挑战一个又一个的越变越大，越变越复杂，再被不断拆分，不断分解。</li>
</ul>
</li>
<li><p>Google? Google!</p>
<ul>
<li>能不能用Google，你懂的原因</li>
<li>是否知道Google的搜索规则<ul>
<li><a href="https://support.google.com/websearch/#topic=3378866" target="_blank" rel="external">官方-&gt;使用Google 搜索帮助中心</a></li>
<li><a href="https://support.google.com/websearch/answer/2466433?hl=zh-Hans&ref_topic=3081620" target="_blank" rel="external">官方-&gt;优化网页搜索</a></li>
<li><a href="https://www.zhihu.com/question/20161362" target="_blank" rel="external">知乎-&gt;如何用好谷歌等搜索引擎？</a></li>
<li>Youtube也是Google的一部分呢。</li>
</ul>
</li>
<li>关键词的调整、搜索套路的调整</li>
<li>搜索的韧性，复杂问题大妈需要上百次的搜索尝试，是也乎～</li>
<li>更重要的是问题的拆解、定位</li>
</ul>
</li>
</ul>
<p>信息检索和信息品味在阳志平老师的《工作谈》中有提到～试试看Google之。</p>
<ul>
<li><p>Extreme Programming.Pair Programming</p>
<ul>
<li>解锁新姿势，做全新尝试</li>
<li>立马有了组织线下活动的动力，继续更新我的活动<a href="https://meetup.junyu.pro/" target="_blank" rel="external">记录</a></li>
</ul>
</li>
<li><p>Practise * 10000…. -&gt; expert</p>
<ul>
<li>先动手，再提问</li>
<li>持续动手，一天不Coding，浑身痒痒</li>
<li>代码量上来了，一切都好谈</li>
<li>还可以多看代码，看得多了，也就会写了</li>
</ul>
</li>
<li><p>Docstring &amp; Comment</p>
<ul>
<li>To do: docstring</li>
</ul>
</li>
</ul>
<p>以下是开学典礼后深夜放毒夹带的私货……</p>
<h2 id="Error-Http-404"><a href="http://blog.junyu.io/atom.xml#Error-Http-404" class="headerlink" title="Error Http 404"></a>Error Http 404</h2><p>在去串店的路上，大妈放出了来自互联网远古时代的呐喊，20年收集宫崎骏和久石让动画的心路历程。<br />信息饥渴 -&gt; 信息存储 -&gt; 信息爆炸 -&gt; 信息质量</p>
<p>作为后互联网远古时代的原住民，曾经也有过数百张光盘刻录、硬盘存储的相似经历，不过由于懒，后来放弃了……看到了大妈的<a href="http://zoomquiet.io/collection.html" target="_blank" rel="external">Collection</a>，心中的干柴终于遇到了烈火。继续搞起～</p>
<h2 id="Moinmoin"><a href="http://blog.junyu.io/atom.xml#Moinmoin" class="headerlink" title="Moinmoin"></a>Moinmoin</h2><p>Wiki还是那个wiki，写完<a href="http://blog.junyu.io/posts/0602-wiki-user-guide.html">Wiki上车指南</a>，经历了这几个月的实践，也算是一个有故事的人了，大妈又给了更多的嗯哼：</p>
<ul>
<li>前期的混乱很正常</li>
<li>好好架构</li>
<li>内容丰富了会有变化</li>
<li>自己写插件</li>
</ul>
<h2 id="Debug-Uself"><a href="http://blog.junyu.io/atom.xml#Debug-Uself" class="headerlink" title="Debug Uself"></a>Debug Uself</h2><ul>
<li>深以为然</li>
<li>兴趣</li>
<li>实用+需求出发</li>
<li>Keep Moving<br />这部分纯私货～</li>
</ul>
<h2 id="Reference"><a href="http://blog.junyu.io/atom.xml#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://github.com/ZhangCici/python/issues/9" target="_blank" rel="external">ZhangCici的记录</a></p>
<blockquote class="blockquote-center"><a href="http://blog.junyu.pro" target="_blank" rel="external">完</a></blockquote>


<h2 id="ChangeLog"><a href="http://blog.junyu.io/atom.xml#ChangeLog" class="headerlink" title="ChangeLog"></a>ChangeLog</h2><p>170811 新建</p></div>







<p class="date">
<a href="http://blog.junyu.io/posts/1003-zq-2th-meetup.html">August 11, 2017 09:19 AM</a>
</p>
</div>
</div>


</div>

</div>


<div class="sidebar">
<img src="images/logo.png" width="136" height="136" alt="">

<h2>Subscriptions</h2>
<ul>
<li>
<a href="http://du.zoomquiet.io/atom.xml" title="subscribe"><img src="images/feed-icon-10x10.png" alt="(feed)"></a> <a href="http://du.zoomquiet.io/" title="自怼圈">Debug Uself grp.</a>
</li>
<li>
<a href="https://bambooom.github.io/feed.xml" title="subscribe"><img src="images/feed-icon-10x10.png" alt="(feed)"></a> <a href="http://bambooom.github.io" title="">bambooooooom</a>
</li>
<li>
<a href="http://blog.junyu.io/atom.xml" title="subscribe"><img src="images/feed-icon-10x10.png" alt="(feed)"></a> <a href="http://blog.junyu.io/" title="浚宇的博客">junyu</a>
</li>
<li>
<a href="https://liguanghe.github.io/rss2.xml" title="subscribe"><img src="images/feed-icon-10x10.png" alt="(feed)"></a> <a href="http://liguanghe.github.io/" title="Li Guanghe's blog">li guang he</a>
</li>
<li>
<a href="https://mxclover.github.io/atom.xml" title="subscribe"><img src="images/feed-icon-10x10.png" alt="(feed)"></a> <a href="https://mxclover.github.io/" title="mxclover">mxclover</a>
</li>
<li>
<a href="http://blog.zoomquiet.io/feeds/all.atom.xml" title="subscribe"><img src="images/feed-icon-10x10.png" alt="(feed)"></a> <a href="http://blog.zoomquiet.io/" title="">zoom.quiet</a>
</li>
</ul>

<p>
<strong>Last updated:</strong><br>
August 26, 2017 12:42 AM<br>
<em>All times are UTC.</em><br>
<br>
Powered by:<br>
<a href="http://www.planetplanet.org/"><img src="images/planet.png" width="80" height="15" alt="Planet" border="0"></a>
</p>

<p>
<h2>Planetarium:</h2>
<ul>
<li><a href="http://www.planetapache.org/">Planet Apache</a></li>
<li><a href="http://planet.debian.net/">Planet Debian</a></li>
<li><a href="http://planet.freedesktop.org/">Planet freedesktop.org</a></li>
<li><a href="http://planet.gnome.org/">Planet GNOME</a></li>
<li><a href="http://planetsun.org/">Planet Sun</a></li>
<li><a href="http://fedora.linux.duke.edu/fedorapeople/">Fedora People</a></li>
<li><a href="http://www.planetplanet.org/">more...</a></li>
</ul>
</p>
</div>
</body>

</html>
