<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>











<head>
<title>Planet DebugUself</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="generator" content="Planet/2.0 +http://www.planetplanet.org">
<link rel="stylesheet" href="planet.css" type="text/css">
<link rel="alternate" href="http://planet.du.zoomquiet.us/atom.xml" title="" type="application/atom+xml">
</head>

<body>
<h1>Planet DebugUself</h1>

<div class="daygroup">
<h2>September 22, 2019</h2>

<div class="channelgroup">







<h3><a href="http://liguanghe.github.io/" title="Li Guanghe's blog">li guang he</a></h3>


<div class="entrygroup" id="http://liguanghe.github.io/2019/09/22/LsWritingTheme/">
<h4><a href="http://liguanghe.github.io/2019/09/22/LsWritingTheme/">初衷</a></h4>
<div class="entry">
<div class="content">
<p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g786cap05wj31400u0b2b.jpg" alt="" /></p>
<p>忙碌的生活会让人忘记初衷的啊. </p>
<p>想着写一份博客变更声明, 告知原本关注了</p></div>







<p class="date">
<a href="http://liguanghe.github.io/2019/09/22/LsWritingTheme/">September 22, 2019 05:35 AM</a>
</p>
</div>
</div>


</div>

</div>
<div class="daygroup">
<h2>September 18, 2019</h2>

<div class="channelgroup">







<h3><a href="http://weekly.pychina.org/" title="蠎周刊">蠎周刊</a></h3>


<div class="entrygroup" id="tag:weekly.pychina.org,2019-09-18:/issue/issue-386.html">
<h4><a href="http://weekly.pychina.org/issue/issue-386.html">Issue 386</a></h4>
<div class="entry">
<div class="content">
<p>原文: <a href="https://pycoders.com/issues/386">PyCoder's Weekly - Issue #386</a></p>
<p><img alt="PyCoder" src="https://cdn.pycoders.com/37bdf31dc645f968ffb90196e5d38ff5" /></p>
<ul>
<li>190918 <a href="http://zoomquiet.io/">Zoom.Quiet</a>(大妈) 用时 42 分钟 完成快译</li>
<li>190918 <a href="http://zoomquiet.io/">Zoom.Quiet</a>(大妈) 用时 17 分钟 完成格式转抄.</li>
</ul>
<hr />
<ul>
<li><a href="https://pycoders.com/link/2515/web">Call for Proposals for PyCon 2020 Is Open</a><ul>
<li>PYCON.BLOGSPOT.COM</li>
</ul>
</li>
</ul>
<p>The submission deadlines are: Tutorial proposals are due November 22, 2019. Talk, Charlas, Poster, and Education Summit proposals are due December 20, 2019.</p>
<p>(<code>是也乎:</code></p>
<p>对比 <a href="https://cn.pycon.org/">PyCon China 2019</a></p>
<p>我们才开始, 人家已经面向 2020 了...
其实, 这才是应该的节奏;</p>
<p>不过, 今年 PyCon19中国, 扩张到6个城市, 也是世界之最了.</p>
<p>欢迎来嗯哼, 俺也去其中一个, 猜, 哪个?</p>
<p>)</p>
<ul>
<li><a href="https://pycoders.com/link/2514/web">Python vs C++: Selecting the Right Tool for the Job</a><ul>
<li>REAL PYTHON</li>
</ul>
</li>
</ul>
<p>Explore the similarities and differences you’ll find when comparing Python vs C++. You’ll learn about memory management, virtual machines, object-oriented programming differences, and much more.</p>
<p>(<code>是也乎:</code></p>
<p><img alt="" src="https://ipic.zoomquiet.top/2019-09-18-ScreenShot%202019-09-18%2017.20.14.jpg" /></p>
<p>其实, C++ 是创始人都在警告: <a href="http://open-std.org/JTC1/SC22/WG21/docs/papers/2018/p0977r0.pdf">想想瓦萨号</a> 的一种失控语言</p>
<p>)</p>
<ul>
<li><a href="https://pycoders.com/link/2508/web">PEP 603: Adding a frozenmap Type to collections</a><ul>
<li>PYTHON.ORG</li>
</ul>
</li>
</ul>
<p>A draft PEP that proposes adding a new fully persistent and immutable mapping type called frozenmap to the collections module in the Python standard library.</p>
<p>(<code>是也乎:</code></p>
<p>不可变量是系统安全的基础, 可惜...</p>
<p>)</p>
<ul>
<li><a href="https://pycoders.com/link/2496/web">Java Primer for Python Developers</a><ul>
<li>MAX MAUTNER</li>
</ul>
</li>
</ul>
<p>“There are large distinctions between the two programming languages, but I’ll try to give the most notable that I encountered–as I approached Java from a Python-heavy background.”</p>
<ul>
<li><a href="https://pycoders.com/link/2499/web">The Boring Technology Behind a One-Person Internet Company</a>
    WENBING FANG</li>
</ul>
<p>The Python-powered tech stack of a one-person company (ListenNotes podcast search engine).</p>
<p>(<code>是也乎:</code></p>
<p>单人企业就得优先选择 <code>无聊技术栈</code>;
终于, Python 从 PHP 手中抢走了这一称号.</p>
<p>)</p>
<ul>
<li><a href="https://pycoders.com/link/2507/web">Types for Python HTTP APIs</a><ul>
<li>ANIRUDH PADMARAO </li>
<li>(INSTAGRAM)</li>
</ul>
</li>
</ul>
<p>How Instagram uses types to document and enforce a contract for their Python HTTP APIs.</p>
<h2>讨论</h2>
<blockquote>
<p>Discussions</p>
</blockquote>
<ul>
<li><a href="https://pycoders.com/link/2497/web">What Are Some of the Drawbacks of Python?</a><ul>
<li>QUORA.COM</li>
</ul>
</li>
</ul>
<p>Also see the related discussion on Hacker News.</p>
<ul>
<li><a href="https://pycoders.com/link/2501/web">How Common Is Python in the Enterprise World?</a><ul>
<li>REDDIT</li>
</ul>
</li>
</ul>
<p>(<code>是也乎:</code></p>
<p>在企业世界 Python 到底流行卟?</p>
<div class="highlight"><pre><span class="err">然</span>
</pre></div>


<p>)</p>
<h2>文章,教程和嗯哼</h2>
<blockquote>
<p>Articles, Tutorials and Talks</p>
</blockquote>
<ul>
<li><a href="https://pycoders.com/link/2518/web">PyGame: A Primer on Game Programming in Python</a><ul>
<li>REAL PYTHON</li>
</ul>
</li>
</ul>
<p>Learn how to use PyGame. This library allows you to create games and rich multimedia programs in Python. You’ll see how to draw items on your screen, implement collision detection, handle user input, and much more!</p>
<p>(<code>是也乎:</code></p>
<p><img alt="" src="https://ipic.zoomquiet.top/2019-09-18-ScreenShot%202019-09-18%2017.13.54.jpg" /></p>
<p>其实, PyGame 才是 Python 世界中最受欢迎的 GUI 框架.</p>
<p>)</p>
<ul>
<li><a href="https://pycoders.com/link/2494/web">How “Export to Excel” Almost Killed Our System</a><ul>
<li>HAKI BENITA</li>
</ul>
</li>
</ul>
<p>“Inspired by an actual incident we had in one of our systems caused by an Export to Excel functionality implemented in Python, we go through the process of identifying the problem, experimenting and benchmarking different solutions.”</p>
<p>(<code>是也乎:</code></p>
<p>其实, 特别想说声: 活该</p>
<p>)</p>
<ul>
<li><a href="https://pycoders.com/link/2517/web">JPMorgan’s Athena Has 35 Million Lines of Python 2 Code, and Won’t Be Updated to Python 3 in Time</a><ul>
<li>JAMES SANDERS</li>
</ul>
</li>
</ul>
<p>“With 35 million lines of Python code, the Athena trading platform is at the core of JPMorgan’s business operations. A late start to migrating to Python 3 could create a security risk.”</p>
<p>(<code>是也乎:</code></p>
<p>JP魔根曰了, 俺不升级...</p>
<p>)</p>
<ul>
<li><a href="https://pycoders.com/link/2510/web">Should You Use “Dot Notation” or “Bracket Notation” With Pandas?</a><ul>
<li>KEVIN MARKHAM</li>
</ul>
</li>
</ul>
<p>There are two ways to select a Series from a DataFrame: “dot notation” and “bracket notation” (square brackets). Find out which one you should use, and why.</p>
<p>(<code>是也乎:</code></p>
<p>哪儿哪儿都有隐技.</p>
<p>)</p>
<ul>
<li><a href="https://pycoders.com/link/2505/web">LEGB? Meet ICPO, Python’s Search Strategy for Attributes</a><ul>
<li>REUVEN LERNER</li>
</ul>
</li>
</ul>
<p>How Python looks up object attributes like obj.name using a “instance, class, parent, object” search algorithm.</p>
<p>(<code>是也乎:</code></p>
<p>OOP 是邪魔...叕来一堆新缩写.</p>
<p>)</p>
<ul>
<li><a href="https://pycoders.com/link/2495/web">Never Delete PyPI Release</a><ul>
<li>ALEX BECKER </li>
<li>• Shared by Alex Becker</li>
</ul>
</li>
</ul>
<p>Why you should (almost) never delete a bad release from PyPI—and what to do as a package maintainer instead.</p>
<p>(<code>是也乎:</code></p>
<p>历史应该是绝对的...</p>
<p>)</p>
<ul>
<li><a href="https://pycoders.com/link/2498/web">Python Does What?! Welcome to the float Zone…</a><ul>
<li>PYTHONDOESWHAT.COM</li>
</ul>
</li>
</ul>
<p>A Python “gotcha” involving floating point numbers and tuples.</p>
<p>(<code>是也乎:</code></p>
<p>Python 暗黑旮旯故事...</p>
<p>)</p>
<ul>
<li>
<p><a href="https://pycoders.com/link/2504/web">Python heapq Module and Heap Data Structure Explained With Examples</a></p>
<ul>
<li>MEENAKSHI AGARWAL</li>
</ul>
</li>
<li>
<p><a href="https://pycoders.com/link/2511/web">Fastest Python Function to Slugify a String</a></p>
<ul>
<li>PETER BENGTSSON</li>
</ul>
</li>
</ul>
<p>(<code>是也乎:</code></p>
<p>URI 安全用</p>
<p>)</p>
<h2>好物</h2>
<blockquote>
<p>Interesting Projects, Tools and Libraries, Projects &amp; Code</p>
</blockquote>
<ul>
<li>
<p><a href="https://pycoders.com/link/2520/web">python-intervals: Data Structure and Operations for Intervals</a></p>
<ul>
<li>GITHUB.COM/ALEXANDREDECAN </li>
<li>• Shared by Alexandre Decan</li>
</ul>
</li>
<li>
<p><a href="https://pycoders.com/link/2500/web">PyCParser: C Parser and Interpreter Written in Python With Automatic ctypes Interface Generation</a></p>
<ul>
<li>GITHUB.COM/ALBERTZ</li>
</ul>
</li>
</ul>
<p>(<code>是也乎:</code></p>
<p>屌的...</p>
<p>)</p>
<ul>
<li><a href="https://pycoders.com/link/2512/web">MyHDL: Design Hardware With Python</a><ul>
<li>MYHDL.ORG</li>
</ul>
</li>
</ul>
<p>(<code>是也乎:</code></p>
<blockquote>
<p>From Python to Silicon!</p>
</blockquote>
<p>嗯哼, 这个 Slogan 够梗的...</p>
<p>)</p>
<ul>
<li>
<p><a href="https://pycoders.com/link/2509/web">Neural Modules: Toolkit for Conversational AI</a></p>
<ul>
<li>GITHUB.COM/NVIDIA</li>
</ul>
</li>
<li>
<p><a href="https://pycoders.com/link/2519/web">30-seconds-of-python: Collection of Python Snippets That You Can Understand in 30 Seconds or Less</a></p>
<ul>
<li>GITHUB.COM/30-SECONDS</li>
</ul>
</li>
</ul>
<p>(<code>是也乎:</code></p>
<p>每一条都可以是个播客节目了...</p>
<p><img alt="" src="https://ipic.zoomquiet.top/2019-09-18-ScreenShot%202019-09-18%2015.59.38.jpg" /></p>
<p>)</p>
<ul>
<li>
<p><a href="https://pycoders.com/link/2506/web">ml-workspace: All-In-One Web-Based IDE Specialized for Machine Learning and Data Science</a></p>
<ul>
<li>GITHUB.COM/ML-TOOLING </li>
<li>• Shared by Lukas Masuch</li>
</ul>
</li>
<li>
<p><a href="https://pycoders.com/link/2502/web">awesome-python-typing: Python Type Stubs, Plugins, and Tools</a></p>
<ul>
<li>GITHUB.COM/TYPEDDJANGO</li>
</ul>
</li>
</ul>
<p>(<code>是也乎:</code></p>
<p>awesome 已经是github 第一子品牌了...
)</p>
<h2>📆🐍 活动/大会</h2>
<blockquote>
<p>Events, MeetUp 真的是全球线下活动组织中心</p>
</blockquote>
<ul>
<li><a href="https://cn.pycon.org/">PyCon China 2019</a><ul>
<li>190921 ~ 191026</li>
<li>上海/北京</li>
<li>杭州/深圳</li>
<li>成都/南宁</li>
</ul>
</li>
</ul>
<p>(<code>是也乎:</code></p>
<p>大妈去 南宁 嗯哼
)</p>
<ul>
<li>
<p><a href="https://pycoders.com/link/2487/web">⋅ PyCon TW 2019</a></p>
<ul>
<li>September 20 to September 23, 2019</li>
<li>中央研究院 </li>
<li>人文社會科學館 </li>
</ul>
</li>
<li>
<p><a href="https://pycoders.com/link/2489/web">⋅ DjangoCon US</a></p>
<ul>
<li>September 22 to September 28, 2019</li>
</ul>
</li>
</ul>
<p>(<code>是也乎:</code></p>
<p>DjangoGirls 活动大放光芒的社区...</p>
<p>)</p>
<ul>
<li><a href="https://pycoders.com/link/2486/web">⋅ PyWeek 28</a><ul>
<li>September 22 to September 30, 2019</li>
<li>线上</li>
</ul>
</li>
</ul>
<h2>DAMA</h2>
<blockquote>
<p>❤️ Happy Pythonic ;-(<code>大妈私人无责任播报</code>)</p>
</blockquote>
<ul>
<li><strong><a href="https://py.101.camp/">蟒营 Python 入门班</a></strong><ul>
<li>第3期</li>
<li>101camp3py</li>
</ul>
</li>
</ul>
<p>第3期已经上线, 为期6周</p>
<ul>
<li><strong>明天截止</strong> 最后24小时机会...</li>
<li>190922 正式开课;</li>
<li>
<p>191103 按时结束;</p>
</li>
<li>
<p><a href="http://zh.tfug.world/2019-09/et-tf-all-around-summary/">首次 TensorFlow All Around 小结 . TFUG Livin ZhuHai Life;-)</a></p>
<ul>
<li>TFUG 珠海</li>
<li>极简汇率</li>
</ul>
</li>
</ul>
<p>(<code>是也乎:</code></p>
<p>没想到触发出一个 <code>DoIs</code> ~ 真正实用的 AI 落地方向:
辅助识别野外白海豚...</p>
<p>)</p>
<h1>是也乎</h1>
<blockquote>
<p>NN 3774</p>
</blockquote>
<ul>
<li>首发: <a href="http://weekly.pychina.org/issue/issue-386.html">Issue 386 ~蠎周刊 ~汇集全球蠎事儿 ;-)</a></li>
<li>改进: <a href="https://github.com/PyChina/weekly/blob/master/content/Issue/issue-386.md">issue-386.md</a></li>
</ul></div>







<p class="date">
<a href="http://weekly.pychina.org/issue/issue-386.html">by Zoom.Quiet at September 18, 2019 03:42 AM</a>
</p>
</div>
</div>


</div>

</div>
<div class="daygroup">
<h2>September 12, 2019</h2>

<div class="channelgroup">







<h3><a href="http://bambooom.github.io" title="Bambooom">bambooooooom</a></h3>


<div class="entrygroup" id="http://bambooom.github.io/2019/09/12/vue-i18n-extract-update/" lang="en-us">
<h4><a href="http://bambooom.github.io/2019/09/12/vue-i18n-extract-update/">extract and update messages for vue-i18n</a></h4>
<div class="entry">
<div class="content">
<p>搞 Vue i18n 的时候暂时了解有两套方案。一套是主要用 <a href="https://github.com/Polyconseil/vue-gettext">vue-gettext</a>
以及搭配 GNU gettext utilities 的几个 command (<code class="highlighter-rouge">msgmerge</code> / <code class="highlighter-rouge">msginit</code> / <code class="highlighter-rouge">msgattrib</code>)一起使用，整体工具链用起来并不是很舒服，上手难度并不小。
vue-gettext 本身也有几个 known issue 无法解决。
作为前端，比较希望能完全用 js 解决就好，不需要依赖其他。
然后才开始仔细研究另一种方案，也就是 <a href="https://github.com/kazupon/vue-i18n">vue-i18n</a>。因为这个库的作者也是 vuejs core team，看着 star 最多，大概也是比较靠谱的。</p>

<p>大致试过之后觉得 vue-i18n 使用起来比 gettext 系列简单轻巧多了，唯一的不足是翻译的 messages 文件需要自己手写。</p>

<p>如果添加了新的页面，有新的 string 需要翻译，或者有些页面文字修改了，翻译也需要同步修改的时候，
vue-i18n 就似乎没有这个 extract &amp; update 的功能。</p>

<p>理想的工作流程是做页面的时候，文字全部都按照默认语言写上并标注（vue-i18n 的情况就是用上 <code class="highlighter-rouge">$t</code> 或者 <code class="highlighter-rouge">$tc</code> 等）。页面完成后，启用某个 npm script 即可生成或者更新待翻译的文件。
最不希望的就是在做页面中间或者完成后，还得自己记得维护去更新待翻译的字符串。</p>

<p>今天又搜索了一下能提取 vue-i18n 标注的现成方案，暂时只找到一个比较靠谱的，
<a href="https://github.com/pixari/vue-i18n-extract/">vue-i18n-extract</a>。</p>

<p>npm install 试了一下之后又仔细看了看文档和 issue，发现 vue-i18n-extract 其实也只做了 extract 部分，更新现有文件部分处于讨论阶段，并没有完成。
但是这个工具的作者做了提取之后也做了一个与现有翻译文件的比较，所以可以输出一个 <code class="highlighter-rouge">report</code>，
也就是我最想知道的哪些 string 还不在文件里（<code class="highlighter-rouge">missingKeys</code>），以及哪些已经不存在了（<code class="highlighter-rouge">unusedKeys</code>）。</p>

<p><code class="highlighter-rouge">report</code> 本身就是个 plain object，自己基于这个再加工一下不就可以得到自己想要的东西了嘛！</p>

<h2 id="demo">Demo</h2>

<p>假设现在有这么两个翻译文件</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// lang/en_US.js</span>
<span class="k">export</span> <span class="k">default</span> <span class="p">{</span>
  <span class="s1">'a-hello'</span><span class="p">:</span> <span class="s1">'Hello World!'</span><span class="p">,</span>
  <span class="s1">'b-hello'</span><span class="p">:</span> <span class="s1">'Hello Banana!'</span><span class="p">,</span>
  <span class="c1">//'c-hello': 'Hello Catherine!',</span>
<span class="p">}</span>

<span class="c1">// lang/zh_CN.js</span>
<span class="k">export</span> <span class="k">default</span> <span class="p">{</span>
  <span class="s1">'a-hello'</span><span class="p">:</span> <span class="s1">'你好世界！'</span><span class="p">,</span>
  <span class="s1">'b-hello'</span><span class="p">:</span> <span class="s1">'你好🍌！'</span><span class="p">,</span>
  <span class="c1">//'c-hello': '你好凯瑟琳！',</span>
<span class="p">}</span>
</code></pre></div></div>

<p>然后在页面上有一个新的 <code class="highlighter-rouge">c-hello</code> 需要提取出来进行翻译。
简单写个 helper script:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// extract.js</span>
<span class="kd">const</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'fs'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'path'</span><span class="p">);</span>
<span class="kd">const</span> <span class="p">{</span><span class="nx">promisify</span><span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'util'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">Extract</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'vue-i18n-extract'</span><span class="p">).</span><span class="k">default</span><span class="p">;</span>

<span class="cm">/* global __dirname */</span>
<span class="kd">const</span> <span class="nx">readDir</span> <span class="o">=</span> <span class="nx">promisify</span><span class="p">(</span><span class="nx">fs</span><span class="p">.</span><span class="nx">readdir</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">writeFile</span> <span class="o">=</span> <span class="nx">promisify</span><span class="p">(</span><span class="nx">fs</span><span class="p">.</span><span class="nx">writeFile</span><span class="p">);</span>

<span class="p">(</span><span class="k">async</span><span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">langFiles</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">readDir</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="s1">'./lang'</span><span class="p">));</span>
  <span class="nx">langFiles</span> <span class="o">=</span> <span class="nx">langFiles</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">file</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">cwd</span><span class="p">(),</span> <span class="nx">file</span><span class="p">);</span>
  <span class="p">});</span>

  <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">file</span> <span class="k">of</span> <span class="nx">langFiles</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">langModule</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="nx">file</span><span class="p">);</span>
    <span class="c1">// get the lang messages as an object</span>
    <span class="kd">const</span> <span class="nx">langObj</span> <span class="o">=</span> <span class="p">(</span><span class="nx">langModule</span><span class="p">.</span><span class="k">default</span><span class="p">)</span> <span class="p">?</span> <span class="nx">langModule</span><span class="p">.</span><span class="k">default</span> <span class="p">:</span> <span class="nx">langModule</span><span class="p">;</span>
    <span class="c1">// extract .vue/.js files and compare with current lang files</span>
    <span class="kd">const</span> <span class="nx">report</span> <span class="o">=</span> <span class="nx">Extract</span><span class="p">.</span><span class="nx">createI18NReport</span><span class="p">(</span><span class="s1">'./path/to/vue-files/**/*.?(js|vue)'</span><span class="p">,</span> <span class="nx">file</span><span class="p">);</span>
    <span class="c1">// report object has two major parts:</span>
    <span class="c1">// - `missingKeys` part are those msgs lack of translations, not in current po file</span>
    <span class="c1">// - `unusedKeys` part are those msgs not present in vue/js files</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">item</span> <span class="k">of</span> <span class="nx">report</span><span class="p">.</span><span class="nx">missingKeys</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">langObj</span><span class="p">[</span><span class="nx">item</span><span class="p">.</span><span class="nx">path</span><span class="p">]</span> <span class="o">=</span> <span class="nx">item</span><span class="p">.</span><span class="nx">path</span><span class="p">;</span> <span class="c1">// add missing string, default same as the source</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">item</span> <span class="k">of</span> <span class="nx">report</span><span class="p">.</span><span class="nx">unusedKeys</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">delete</span> <span class="nx">langObj</span><span class="p">[</span><span class="nx">item</span><span class="p">.</span><span class="nx">path</span><span class="p">];</span> <span class="c1">// remove unused string</span>
    <span class="p">}</span>

    <span class="c1">// langObj had been synced with vue/js files with latest message strings</span>
    <span class="c1">// now update the lang files</span>
    <span class="kd">const</span> <span class="nx">langStr</span> <span class="o">=</span> <span class="s1">'export default '</span> <span class="o">+</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">langObj</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
    <span class="kr">await</span> <span class="nx">writeFile</span><span class="p">(</span><span class="nx">file</span><span class="p">,</span> <span class="nx">langStr</span><span class="p">,</span> <span class="s1">'utf-8'</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Updated all lang files'</span><span class="p">);</span>
<span class="p">})();</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">node extract.js</code> 之后待翻译文件应该会变成这样：</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// lang/en_US.js</span>
<span class="k">export</span> <span class="k">default</span> <span class="p">{</span>
  <span class="s1">'a-hello'</span><span class="p">:</span> <span class="s1">'Hello World!'</span><span class="p">,</span>
  <span class="s1">'b-hello'</span><span class="p">:</span> <span class="s1">'Hello Banana!'</span><span class="p">,</span>
  <span class="s1">'c-hello'</span><span class="p">:</span> <span class="s1">'c-hello'</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1">// lang/zh_CN.js</span>
<span class="k">export</span> <span class="k">default</span> <span class="p">{</span>
  <span class="s1">'a-hello'</span><span class="p">:</span> <span class="s1">'你好世界！'</span><span class="p">,</span>
  <span class="s1">'b-hello'</span><span class="p">:</span> <span class="s1">'你好🍌！'</span><span class="p">,</span>
  <span class="s1">'c-hello'</span><span class="p">:</span> <span class="s1">'c-hello'</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></div>

<p>然后再统一进行翻译就可以了。</p>

<p>最后，仔细想了想，我可以比较简单处理 extract 的结果是因为我在 language files 里不使用复杂的嵌套结构，
和传统的 po 文件一致，就是 key：value 的一一对应关系，但很多使用 vue-i18n 的人大概还会利用 js object 嵌套很深，
比如 <a href="https://github.com/pixari/vue-i18n-extract/tree/master/demo">vue-i18n-extract 的 demo</a> 中给的一个例子就是这个样子：</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// de_DE.js</span>
<span class="k">export</span> <span class="k">default</span> <span class="p">{</span>
  <span class="na">header</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">titles</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">title_a</span><span class="p">:</span> <span class="s1">'test'</span><span class="p">,</span>
      <span class="na">title_b</span><span class="p">:</span> <span class="s1">'test'</span><span class="p">,</span>
      <span class="na">title_c</span><span class="p">:</span> <span class="s1">'test'</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="na">paragraphs</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">p_a</span><span class="p">:</span> <span class="s1">'test'</span><span class="p">,</span>
      <span class="na">p_b</span><span class="p">:</span> <span class="s1">'test'</span><span class="p">,</span>
    <span class="p">},</span>
  <span class="p">},</span>
<span class="p">};</span>
</code></pre></div></div>

<p>如果是这个情况，更新起来的确费事一些，但根据自己实际情况，应该也还是可以处理的。</p></div>







<p class="date">
<a href="http://bambooom.github.io/2019/09/12/vue-i18n-extract-update/">by bambooom (zhuzi.mn@gmail.com) at September 12, 2019 04:42 PM</a>
</p>
</div>
</div>


</div>

</div>


<div class="sidebar">
<img src="images/logo.png" width="136" height="136" alt="">

<h2>Subscriptions</h2>
<ul>
<li>
<a href="https://bambooom.github.io/feed.xml" title="subscribe"><img src="images/feed-icon-10x10.png" alt="(feed)"></a> <a href="http://bambooom.github.io" class="message" title="internal server error">bambooooooom</a>
</li>
<li>
<a href="http://blog.junyu.io/atom.xml" title="subscribe"><img src="images/feed-icon-10x10.png" alt="(feed)"></a> <a href="http://blog.junyu.io/" class="message" title="404: not found">junyu</a>
</li>
<li>
<a href="https://liguanghe.github.io/rss2.xml" title="subscribe"><img src="images/feed-icon-10x10.png" alt="(feed)"></a> <a href="http://liguanghe.github.io/" title="Li Guanghe's blog">li guang he</a>
</li>
<li>
<a href="https://mxclover.github.io/atom.xml" title="subscribe"><img src="images/feed-icon-10x10.png" alt="(feed)"></a> <a href="https://mxclover.github.io/" title="mxclover">mxclover</a>
</li>
<li>
<a href="http://sumin.ink/feed.xml" title="subscribe"><img src="images/feed-icon-10x10.png" alt="(feed)"></a> <a href="http://sumin.ink" title="Su Min's blog">sumin</a>
</li>
<li>
<a href="https://zoejane.netlify.com/index.xml" title="subscribe"><img src="images/feed-icon-10x10.png" alt="(feed)"></a> <a href="http://blog.zoejane.net/" title="Zoe Jane">zoejane</a>
</li>
<li>
<a href="https://blog.zoomquiet.io/feeds/all.atom.xml" title="subscribe"><img src="images/feed-icon-10x10.png" alt="(feed)"></a> <a href="https://blog.zoomquiet.io/" title="">zoom.quiet</a>
</li>
<li>
<a href="http://www.ocselected.org/feed.xml" title="subscribe"><img src="images/feed-icon-10x10.png" alt="(feed)"></a> <a href="http://www.ocselected.org/feed/index.xml" class="message" title="404: not found">开源之道</a>
</li>
<li>
<a href="https://du.101.camp/atom.xml" title="subscribe"><img src="images/feed-icon-10x10.png" alt="(feed)"></a> <a href="https://du.101.camp/" class="message" title="internal server error">自怼圈</a>
</li>
<li>
<a href="http://weekly.pychina.org/feeds/all.atom.xml" title="subscribe"><img src="images/feed-icon-10x10.png" alt="(feed)"></a> <a href="http://weekly.pychina.org/" title="蠎周刊">蠎周刊</a>
</li>
</ul>

<p>
<strong>Last updated:</strong><br>
September 22, 2019 04:42 PM<br>
<em>All times are UTC.</em><br>
<br>
Powered by:<br>
<a href="http://www.planetplanet.org/"><img src="images/planet.png" width="80" height="15" alt="Planet" border="0"></a>
</p>

<p>
<h2>Planetarium:</h2>
<ul>
<li><a href="http://www.planetapache.org/">Planet Apache</a></li>
<li><a href="http://planet.debian.net/">Planet Debian</a></li>
<li><a href="http://planet.freedesktop.org/">Planet freedesktop.org</a></li>
<li><a href="http://planet.gnome.org/">Planet GNOME</a></li>
<li><a href="http://planetsun.org/">Planet Sun</a></li>
<li><a href="http://fedora.linux.duke.edu/fedorapeople/">Fedora People</a></li>
<li><a href="http://www.planetplanet.org/">more...</a></li>
</ul>
</p>
</div>
</body>

</html>
